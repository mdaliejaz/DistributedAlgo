<?xml version="1.0"?>
<!-- sample policy.  CSE 535, Fall 2016, Scott Stoller.  2016-10-03 -->
<policy>

    <rule name="access bank A first time">
        <subjectCondition position="employee" history=""></subjectCondition>
        <resourceCondition id="bank A"></resourceCondition>
        <!-- the action authorized by this rule. -->
        <action name="read"></action>
        <subjectUpdate history="bank A"></subjectUpdate>
    </rule>

    <rule name="access bank A again">
        <subjectCondition position="employee"
                          history="$resource.id"></subjectCondition>
        <resourceCondition id="bank A"></resourceCondition>
        <action name="read"></action>
    </rule>

    <rule name="access bank B first time">
        <subjectCondition position="employee" history=""></subjectCondition>
        <resourceCondition id="bank B"></resourceCondition>
        <action name="read"></action>
        <subjectUpdate history="bank B"></subjectUpdate>
    </rule>

    <rule name="access bank B again">
        <subjectCondition position="employee"
                          history="bank B"></subjectCondition>
        <resourceCondition id="bank B"></resourceCondition>
        <action name="read"></action>
    </rule>

    <rule name="viewers collectively can view each movie at most 2 times">
        <subjectCondition position="viewer"></subjectCondition>
        <resourceCondition type="movie" viewCount="&lt;2"></resourceCondition>
        <action name="view"></action>
        <resourceUpdate viewCount="++"></resourceUpdate>
    </rule>

    <rule name="listeners collectively can listen a song at most 5 times">
        <subjectCondition position="listener"></subjectCondition>
        <resourceCondition type="song" viewCount="&lt;5"></resourceCondition>
        <action name="view"></action>
        <resourceUpdate viewCount="++"></resourceUpdate>
    </rule>

</policy>
